<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>4_11.mdown—/Users/yuchimatsuoka/Google ドライブ/Seminar/M1basic</title>
    <link rel="stylesheet" href="../stylesheets/styles.css">
    <link rel="stylesheet" href="../stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML">
       MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
    </script>
  </head>
 <body>
         <div class="wrapper">
       <header>
         <h1>Yuchi MATSUOKA <br> 松岡 佑知</h1>
         <p>
       <a href="http://www.sigmath.es.osaka-u.ac.jp/kano-lab/wp/">Kano/Hamada lab.</a> M1 <br>
       Graduate School of Engineering Science, Osaka University <br>
       1-3 Machikaneyama-cho, Toyonaka, Osaka 560-8531 <br>
       yuchi_m [ at ] icloud.com</p>
 
 
         <p class="view"><a href="https://github.com/yuchimatsuoka">View My GitHub Profile</a></p>
         <p class="view"><a href="seminar.html">Seminar</a></p>
       </header>
       <section>

    <div class="container">

      <div id="markup">
        <article id="content" class="markdown-body">
          <h2>第１回基礎ゼミ参考資料</h2>
<p><div style="text-align: right;">
writen by Yuchi MATSUOKA </p>
<p>Last modified 8, April, 2016
</div></p>
<hr>
<h3>Portmanteau's Lemma(ポートマントーの補題)</h3>
<p>任意の確率ベクトル $X_n$ と $X$ に対して以下の7つのstatementは同値である．</p>
<ol>
<li>$x \mapsto P(X \leq x)$の任意の連続点において$P(X_n \leq x) \rightarrow P(X\leq x)$.</li>
<li>任意の有界連続関数 $f$ に対して $Ef(X_n) \rightarrow Ef(X)$.</li>
<li>任意の有界リプシッツ連続関数 $f$ に対して $Ef(X_n) \rightarrow Ef(X)$.</li>
<li>任意の非負連続関数$f$に対して，$\liminf Ef(X_n) \geq Ef(X)$.</li>
<li>任意の開集合$G$に対して，$\liminf P(X_n \in G)\geq P(X\in G)$.</li>
<li>任意の閉集合$G$に対して，$\limsup P(X_n \in F)\leq P(X\in F)$.</li>
<li>$P(X\in \delta B) =0$となるような任意のボレル集合$B$に対して，$P(X_n \in B) \rightarrow P(X\in B)$.</li>
</ol>
<h4>動機付け</h4>
<p>分布収束の同値上条件を与える定理であり，基本的には他の定理の証明の道具として用いられる．</p>
<h4>証明</h4>
<p>$(1) \Rightarrow (2)$, $(2) \Rightarrow (3)$, $(3) \Rightarrow (5)$, $(5) \Leftrightarrow (6)$, $(5)+(6) \Rightarrow (7)$, $(7)\Rightarrow (1)$, $(2) \Leftrightarrow (4)$の順で示す．</p>
<p>$(1) \Rightarrow (2)$.</p>
<p>示すべきことは$|Ef(X_n) - Ef(X)|$の上界が$n$を十分大きくとれば任意の$\epsilon$で抑えられることである．</p>
<p>はじめに，$X$の分布関数は連続であると仮定する．（一般の$X$でも問題ないことはのちに示す．）</p>
<p>(1)より任意の（超）長方形$I$に対して，
$$
P(X_n \in I) \rightarrow P(X \in I)
$$
が明らかに成り立つ．そこで$P(X \not\in I)\leq \epsilon$を満たすように十分大きくコンパクトな長方形$I$をとる．すると連続関数$f$はコンパクト集合$I$上で一様連続であるという有名事実が使える．</p>
<p>$f$が各$I_j$内で高々$\epsilon$しか異ならないように長方形$I$を$I = \cup_j I_j$と分割することができる．これは$f$が$I$上一様連続であることより明らか．</p>
<p>次に期待値の収束を示すために3つの不等式を用意する．これらを用いて三角不等式を作ることで題意は示せる．</p>
<p>まず，各$I_j$から点$x_j$をとり，$f_\epsilon = \sum_j f(x_j) 1_{I_j}$と定義する．すると
\begin{aligned}
|f - f_\epsilon| &amp;&lt; \sup_x |f(x) - f_\epsilon (x)| \\
                &amp;= \sup_x |f(x) -f(x_j)| \\
                &amp;\leq  \epsilon.
\end{aligned}
ここで$f$の値域が$[-1,1]$であるとしても一般性を失わない．
これらを用いて以下の三つが成り立つ．
\begin{aligned}
    |Ef(X_n) - Ef_\epsilon (X_n)| &amp;\leq \epsilon + P(X_n \not\in I),  \\
    |Ef(X) - Ef_\epsilon (X_n)| &amp;\leq \epsilon + P(X \not\in I) &lt; \epsilon, \\
    |Ef_\epsilon(X) - Ef_\epsilon (X_n)| &amp;\leq \sum_j|P(X_n \in I_j)-P(X \in I_j)||f(x_j)| \rightarrow 0. 
\end{aligned}</p>
<p>まずこれら３つを証明する．
一つ目．</p>
<p>\begin{aligned}
    |Ef(X_n) - Ef_\epsilon (X_n)| &amp;= |\int_{Rk}f-f_\epsilon dP(X_n)| \\
    &amp;= |\int_{I}f-f_\epsilon dP(X_n)|+|\int_{Ic}f-f_\epsilon dP(X_n)| \\
    &amp;\leq \int_{I}|f-f_\epsilon| dP(X_n)+|\int_{Ic}f dP(X_n)| \\
\end{aligned}
ここで，$I$上で$|f - f_\epsilon| \leq \epsilon$であることと，$f \leq 1$であることを用いれば，$|Ef(X_n) - Ef_\epsilon (X_n)| \leq \epsilon + P(X_n \not\in I)$である．$n$を十分大きくとれば，結局$2\epsilon$で抑えられることもわかる．</p>
<p>二つ目は全く同様にできる．</p>
<p>三つの不等式を合わせると題意が示せる．</p>
<p>次に$X$の分布関数が連続でない場合でも大丈夫なことを示さなければならない．
まず，分布関数の不連続点は高々加算個である(
後に示す．)．従って長方形$I$を$P(X \in \delta)=0$となるようにとれる．よって分布関数が不連続であっても同様の議論ができる．</p>
<p>$(2) \Rightarrow (3)$はリプシッツ連続な関数は連続関数であることより自明.</p>
<p>$(3) \Rightarrow (5)$を示す．</p>
<p>任意の開集合$G$に対して，$0\leq f_m \uparrow 1_G$となるようなリプシッツ連続な関数列$f_m$が存在する．たとえば，
$$
f_m(x) = \inf{md(x,G^c),1}
$$
は1でバウンドされる$m$リプシッツな関数である(後に示す)．</p>
<p>ここで，$X_n \in G^c$のとき，$f_m(X_n)=0$であるので，
\begin{aligned}
    Ef_m(X_n) &amp;\leq 1\cdot P(X_n\in G) \\
                &amp;= P(X_n\in G).
\end{aligned}</p>
<p>よって，
\begin{aligned} 
    \liminf P(X_n\in G) &amp;\geq \liminf Ef_m(X_n) \\
                        &amp;\geq \lim Ef_m(X_n) \\
                        &amp;= Ef_m(X). \ \ (\because (3))
\end{aligned}</p>
<p>単調収束定理より，$\lim_{m\rightarrow \infty}Ef_m(X) = E 1_G = P(X\in G)$.</p>
<p>よって示せた．</p>
<p>次に，$(5) \Leftrightarrow (6)$. これは補集合をとれば明らか．</p>
<p>$(5)+(6) \Rightarrow (7)$の証明．</p>
<p>まず，ボレル集合$B$の内部を$\mathring{B}$, 閉包を$\bar{B}$とかく．内部は開集合，閉包は閉集合であることから(5)及び(6)を用いて，</p>
<p>\begin{aligned}
    P(X\in \mathring{B}) \leq \liminf P(X_n\in \mathring{B}) \leq \limsup P(X_n\in \bar{B}) \leq P(X\in \bar{B})
\end{aligned}
が成り立つ．</p>
<p>$P(X\in \delta B)= P(X\in \bar{B})-P(X\in\mathring{B}) = 0$であるとき，上式は全て同じ値をとる．よって$P(X_n \in B) \rightarrow P(X\in B)$.</p>
<p>次に$(7)\Rightarrow (1)$を示す．</p>
<p>連続点$x$に対して，$(-\infty,x]$をとると，これはボレル集合であり，$P(X \in \delta (-\infty,x]) = 0$より，(7)が使えて，</p>
<p>$$P(X_n\leq x)\rightarrow P(X \leq x) $$
OK.</p>
<p>$(2) \Rightarrow (4)$.</p>
<p>$M&gt;0$を任意にとり，$f_M(x) := \inf {f(x),M}$とする．このとき，$f_M$は有界かつ連続であり，$f_M \leq f$. よって任意の$n \in \mathbb{N}$に対して，
$$E f_M(X_n) \leq Ef(X_n)$$.</p>
<p>(2)より左辺は$Ef_M(X)$に収束する．よって</p>
<p>$$E f_M(X) \leq Ef(X_n)$$.</p>
<p>さらに，$f_M$は$M$に関して単調増加であるので，単調収束定理が使えて，
$$Ef(X) \leq \liminf Ef(X_n)$$.</p>
<p>よって示せた．</p>
<p>$(4) \Rightarrow (2)$.</p>
<p>$f$は有界かつ連続な関数とする．このとき，$f+||f||_{\infty}$, $||f||_{\infty}-f$は，非負値連続関数である．よって(4)が使えて，</p>
<p>\begin{aligned}
    \liminf Ef(X_n) + ||f||_{\infty} &amp;\geq E f(X)+ ||f||_{\infty} \
     \geq ||f||_{\infty}-Ef(X) &amp;\leq ||f||_{\infty}-\liminf Ef(X_n) \leq ||f||_{\infty}-\limsup Ef(X_n)
\end{aligned}</p>
<p>合わせると，</p>
<p>\begin{aligned}
    \limsup Ef(X_n) \leq Ef(X) \leq \liminf Ef(X_n)
\end{aligned}</p>
<p>これらは全て等しく，さらに$\liminf Ef(X_n) = Ef(X)$である．</p>
<p>以上により一通り示せたことになる．</p>
<hr>
<p>次の結果は基本的であるが非常に有用であり，ポートマントーの補題が証明の中で用いられる．</p>
<h3>Continuous mapping theorem (連続写像の定理).</h3>
<p>$g: \mathbb{R}^k \mapsto \mathbb{R}^m$は$P(X\in C)=1$となるような集合$C$の任意の点で連続であるとする．このとき，</p>
<ol>
<li>$X_n \rightsquigarrow X$ $\Rightarrow$ $g(X_n) \rightsquigarrow g(X)$,</li>
<li>$X_n \xrightarrow{P} X$ $\Rightarrow$ $g(X_n) \xrightarrow{P} g(X)$,</li>
<li>$X_n \xrightarrow{as} X$ $\Rightarrow$ $g(X_n) \xrightarrow{as} g(X)$</li>
</ol>
<p>が成り立つ．</p>
<h4>証明</h4>
<p>(1).</p>
<p>まず，任意の閉集合$F$に対して，以下が成り立つ．</p>
<p>$$
    g^{-1}(F) \subset \overline{g^{-1}(F)} \subset g^{-1}(F) \cup C^c
$$</p>
<p>一つ目の包含関係は明らか．二つ目を示す．任意の$F$に対して，$x_m \rightarrow x$かつ$g(x_m)\in F$を満たすような関数列${x_m}$を考える．</p>
<p>ここで，定義より$x_m \in g^{-1}(F)$. さらに閉包は閉集合であることより$x \in \overline{g^{-1}(F)}$.</p>
<p>このとき$x$には次の二通りの場合がある．</p>
<ul>
<li>$x\in C$の場合<ul>
<li>このとき，$x$は$g$の連続点である．$g(x_k) \rightarrow g(x)$である． さらに$F$は閉集合であるので$g(x)\in F$．よって$x\in g^{-1}(F)$.</li>
</ul>
</li>
<li>$x\in C^c$の場合</li>
</ul>
<p>よって二つ目の包含関係が示せた．</p>
<p>\begin{eqnarray}
    \limsup P(g(X_n)\in F) &amp;\leq \limsup P(X_n\in \overline{g^{-1}(F)}) \ \ \mbox{(自明)} \\
    &amp;\leq  P(X\in \overline{g^{-1}(F)}) \ \ \mbox{(ポートマント(6))} \\
    &amp;=  P(X\in g^{-1}(F)) \ \ \mbox{($P(X\in C^c)=0$)} \\
    &amp;=  P(g(X)\in F). \ \ \mbox{   }
\end{eqnarray}</p>
<p>よってポートマントー(6)から，題意が示せた．</p>
<p>(2).</p>
<p>任意に$\epsilon$を固定する．各$\delta&gt;0$に対して，$B_{\delta}$を次のように定義する．</p>
<p>\begin{eqnarray}
    B_{\delta} :={x\in \mathbb{R}^k: \exists y\in \mathbb{R}^k,d(x,y)&lt;\delta, d(g(x),g(y))&gt;\epsilon  }.
\end{eqnarray}</p>
<p>このとき，$X\not\in B_{\delta}$かつ$d(g(X_n),g(X))&gt;\epsilon$であるとすれば，$d(X_n,X)\geq \delta$ということになる．よって，</p>
<p>\begin{eqnarray}
    P(d(X_n,X)\geq \delta) \leq P(X\in B_{\delta}) + P(d(X_n,X)\geq \delta).
\end{eqnarray}</p>
<p>あとは右辺が$n\rightarrow 0$で0に収束することをいえばよい．2項目は$X_n$が$X$に確率収束することよりOK. 1項目は$g$が$C$で連続であることより，$B_{\delta} \cap C \downarrow 0$より$\delta \downarrow 0$で0に収束する．以上により示せた．</p>
<p>(3). 明らか．</p>
<hr>
<h3>確率変数$X$がtight(緊密)であるとは</h3>
<h3>Prokorov's Theorem (プロホロフの定理)</h3>
<p>$X_n$は$\mathbb{R}^k$上の確率ベクトルであるとする．このとき以下が成り立つ．</p>
<ol>
<li>$X_n \rightsquigarrow X$ $\Rightarrow$ ${X_n}$はuniformly tight.</li>
<li>${X_n}$がuniformly tight　$\Rightarrow$　ある$X$に対して，$X_{n_j} \rightsquigarrow X(j \rightarrow \infty)$となるような確率ベクトル列が存在する．</li>
</ol>
<h4>証明</h4>
<hr>
<h3>Sources</h3>
<ul>
<li>A. W. Van Der Vaart, <em>Asymptotic Statistics</em>, Cambridge University Press</li>
</ul>
<h3>Special Thanks</h3>
<ul>
<li>Mr. Ryunosuke TANABE</li>
</ul>
        </article>
      </div>
    </div>
  </body>
</html>
